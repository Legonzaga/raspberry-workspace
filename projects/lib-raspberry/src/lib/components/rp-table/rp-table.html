@defer{
<table>
  @if(columns()?.length) {
  <thead>
    @for(col of columns(); track col.key) {
    <th>
      <div class="th-description">
        {{ col.text }}
      </div>

      @if(col.filter) {
      <form [formGroup]="filterForm!">
        <div>
          @switch(col.filter.type) {

            @case('select') {
            <select rpSelect title="Filter by"
              [name]="col.key"
              [formControlName]="col.key"
              (change)="inputFiltering($event || '', col.key)">
              @for(op of col.filter.options; track $index) {
                <option [value]="op">{{ op }}</option>
              }
            </select>
            }
            @default {
            <input
              rpInput
              placeholder="Filter by {{ col.text }}"
              [type]="col.filter.type"
              (input)="inputFiltering($event || '', col.key)"
              [formControlName]="col.key"
            />
            }
          }
        </div>
      </form>
      }
    </th>
    }
  </thead>
  }
  <tbody>
    @for(row of (!filteredRows.length ? this.rows() : filteredRows); track $index) {
    <tr>
      @for(column of columns(); track column.text) {
      <td>{{ row[column.key] }}</td>
      }
    </tr>
    }
  </tbody>
</table>
<rp-paginator />
}
